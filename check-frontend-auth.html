<!DOCTYPE html>
<html>
<head>
    <title>Frontend Auth Check</title>
</head>
<body>
    <h1>Frontend Auth Diagnostic</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function log(message) {
            console.log(message);
            results.innerHTML += '<div>' + message + '</div>';
        }
        
        log('üîç Checking frontend authentication...');
        
        // Check localStorage for auth data
        const authData = localStorage.getItem('lessonPlanBuilder_currentUser');
        log('üìä Auth data in localStorage: ' + (authData ? 'Found' : 'NOT FOUND'));
        
        if (authData) {
            try {
                const user = JSON.parse(authData);
                log('üë§ Current user ID: ' + user.id);
                log('üë§ Current user email: ' + user.email);
                
                // Test subscription API
                log('üß™ Testing subscription API...');
                fetch('/api/user/subscription?userId=' + user.id)
                    .then(r => r.json())
                    .then(data => {
                        log('‚úÖ API Response received');
                        log('üìä isPremium: ' + data.subscription?.isPremium);
                        log('üìä isActive: ' + data.subscription?.isActive);
                        log('üìä status: ' + data.subscription?.status);
                        
                        if (data.subscription?.isPremium) {
                            log('üéâ USER IS PREMIUM - Frontend should show premium dashboard!');
                        } else {
                            log('‚ùå API says user is NOT premium');
                        }
                    })
                    .catch(err => {
                        log('‚ùå API call failed: ' + err.message);
                    });
                    
            } catch (err) {
                log('‚ùå Error parsing auth data: ' + err.message);
            }
        } else {
            log('‚ùå No user logged in - this is the problem!');
            log('üí° User needs to log in again for the subscription hook to work');
        }
        
        // Check subscription localStorage
        const mockSub = localStorage.getItem('mockSubscription');
        log('üé≠ Mock subscription in localStorage: ' + (mockSub || 'none'));
    </script>
</body>
</html>